import csv
import datetime

# Open the csv file
with open('data.csv', 'r') as csvfile:
    # Create a csv reader object
    reader = csv.DictReader(csvfile)

    # Create a list to store the updated data
    updated_data = []

    # Loop through each row in the csv file
    for row in reader:
        # Get the value of the 'pk_TimeStamp' column
        timestamp = int(row['pk_TimeStamp'])

        # Convert the timestamp to seconds and subtract 109205
        seconds = (timestamp / 10000000) / 86400 - 109205

        # Split the seconds value into integer and fractional parts
        seconds_int = int(seconds)
        seconds_frac = seconds - seconds_int

        # Format the integer and fractional parts
        date_format = datetime.datetime.fromtimestamp(seconds_int * 86400).strftime('%Y-%m-%d')
        time_format = datetime.datetime.utcfromtimestamp(seconds_frac * 86400).strftime('%H:%M:%S.%f')

        # Update the value of the 'pk_TimeStamp' column
        row['pk_TimeStamp_int'] = date_format
        row['pk_TimeStamp_frac'] = time_format

        # Add the updated row to the list
        updated_data.append(row)

# Open the csv file in write mode
with open('updated_data.csv', 'w', newline='') as csvfile:
    # Get the headers from the first row of the original csv file
    fieldnames = updated_data[0].keys()

    # Create a csv writer object
    writer = csv.DictWriter(csvfile, fieldnames=fieldnames)

    # Write the updated data to the csv file
    writer.writeheader()
    writer.writerows(updated_data)
